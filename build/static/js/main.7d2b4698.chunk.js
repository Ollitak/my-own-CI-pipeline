(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{43:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n.n(r),c=n(17),u=n.n(c),a=n(3),i=n(4),s=n(1),l=n.n(s),d=n(0),b=function(e){var t,n=e.blog,o=e.updatingBlog,c=e.removingBlog,u=e.user,s=Object(r.useState)([]),b=Object(i.a)(s,2),g=b[0],j=b[1],f=function(){j(g.concat(n.id.toString()))},p=function(){j(g.filter((function(e){return e.toString()!==n.id.toString()})))},h=function(){var e=Object(a.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("updating blog..."),t={user:n.user.id,likes:n.likes+1,author:n.author,title:n.title,url:n.url},e.next=4,o(t,n.id.toString());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(a.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("removing blog..."),e.next=3,c(n.id.toString());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t=u?u.username:null;return Object(d.jsxs)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},children:[g.includes(n.id.toString())?Object(d.jsxs)("div",{className:"blog",children:["Title: ",n.title,Object(d.jsx)("button",{onClick:p,children:" hide "}),Object(d.jsx)("br",{}),"Author: ",n.author,Object(d.jsx)("br",{}),"Likes: ",n.likes,Object(d.jsx)("button",{onClick:h,children:" like "}),Object(d.jsx)("br",{}),"Username: ",n.user.username,Object(d.jsx)("br",{}),n.user.username===t?Object(d.jsx)("button",{onClick:v,children:" remove "}):null]}):Object(d.jsxs)("div",{children:[n.title,Object(d.jsx)("button",{onClick:f,children:" view "})]}),Object(d.jsx)("br",{})]})},g=function(e){var t=e.addingBlog,n=Object(r.useState)([]),o=Object(i.a)(n,2),c=o[0],u=o[1],a=Object(r.useState)([]),s=Object(i.a)(a,2),l=s[0],b=s[1],g=Object(r.useState)([]),j=Object(i.a)(g,2),f=j[0],p=j[1];return Object(d.jsx)("div",{children:Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:" create new blog"}),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.log("trying to add blog",c,l," ..."),t({title:c,author:l,url:f}),u(""),b(""),p("")},children:["title:",Object(d.jsx)("input",{id:"titleInput",type:"text",value:c,onChange:function(e){return u(e.target.value)}}),Object(d.jsx)("br",{}),"author:",Object(d.jsx)("input",{id:"authorInput",type:"text",value:l,onChange:function(e){return b(e.target.value)}}),Object(d.jsx)("br",{}),"url:",Object(d.jsx)("input",{id:"urlInput",type:"text",value:f,onChange:function(e){return p(e.target.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{id:"createButton",type:"submit",children:"create"})]})]})})},j=o.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),o=Object(i.a)(n,2),c=o[0],u=o[1],a={display:c?"none":""},s={display:c?"":"none"},l=function(){u(!c)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{style:a,children:Object(d.jsx)("button",{onClick:l,children:e.buttonLabel})}),Object(d.jsxs)("div",{style:s,children:[e.children,Object(d.jsx)("button",{onClick:l,children:"close"})]})]})}));j.displayName="Togglable";var f=j,p=n(6),h=n.n(p),v="/api/blogs",O=null,x=function(){var e=Object(a.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,h.a.post(v,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(a.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.put(v+"/"+n,t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(a.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,h.a.delete(v+"/"+t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w={getAll:function(){return h.a.get(v).then((function(e){return e.data}))},addBlog:x,setToken:function(e){O="bearer ".concat(e)},updateBlog:m,deleteBlog:k},y=function(){var e=Object(a.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S={login:y},B=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(""),u=Object(i.a)(c,2),s=u[0],j=u[1],p=Object(r.useState)(""),h=Object(i.a)(p,2),v=h[0],O=h[1],x=Object(r.useState)(""),m=Object(i.a)(x,2),k=m[0],y=m[1],B=Object(r.useState)(null),T=Object(i.a)(B,2),C=T[0],I=T[1],U=Object(r.useRef)();Object(r.useEffect)((function(){w.getAll().then((function(e){console.log("retreiving blogs..."),e.sort((function(e,t){return t.likes-e.likes})),o(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){console.log("User found from local storage");var t=JSON.parse(e);I(t),w.setToken(t.token)}}),[]);var A=function(){var e=Object(a.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("trying to log in with",s,v," ...."),e.prev=2,e.next=5,S.login({username:s,password:v});case 5:n=e.sent,console.log("succesfull - logged in"),console.log("returned token: ",n.token),window.localStorage.setItem("loggedUser",JSON.stringify(n)),w.setToken(n.token),I(n),j(""),O(""),y("logged in succesfully"),setTimeout((function(){y(null)}),5e3),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(2),console.log("login failed ... please check your credentials"),y("wrong credentials, please check your username and password"),setTimeout((function(){y(null)}),5e3);case 22:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(a.a)(l.a.mark((function e(t){var r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,U.current.toggleVisibility(),e.next=4,w.addBlog(t);case 4:r=e.sent,console.log(r),c=n.concat(r),o(c),console.log("succesfully added ",r.title,"...."),y("blog succesfully added... title: "+r.title),setTimeout((function(){y(null)}),5e3),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("sending a blog to the server failed"),y("sending a blog to the server failed"),setTimeout((function(){y(null)}),5e3);case 18:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(a.a)(l.a.mark((function e(t,r){var c,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.updateBlog(t,r);case 3:c=e.sent,(u=(u=n.filter((function(e){return e.id.toString()!==r}))).concat(c)).sort((function(e,t){return t.likes-e.likes})),o(u),console.log("succesfully updated ",c.title,"...."),y("blog succesfully updated... title: "+c.title),setTimeout((function(){y(null)}),5e3),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("updating the blog failed"),y("updating the blog failed"),setTimeout((function(){y(null)}),5e3);case 18:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(a.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.deleteBlog(t);case 3:console.log("succesfully deleted "),r=n.filter((function(e){return e.id.toString()!==t})),o(r),y("blog succesfully removed"),setTimeout((function(){y(null)}),5e3),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("removing the blog failed"),y("removing the blog failed"),setTimeout((function(){y(null)}),5e3);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),D=function(e){e.preventDefault(),window.localStorage.removeItem("loggedUser"),I(null)};return Object(d.jsxs)("div",{children:[Object(d.jsxs)("h1",{children:[" ",k," "]}),null===C?null:Object(d.jsxs)("div",{children:[Object(d.jsxs)("b",{children:[" ",C.username," logged in "]}),Object(d.jsx)("button",{onClick:D,children:" log out "})]}),null===C?Object(d.jsxs)("form",{onSubmit:A,children:[Object(d.jsx)("h2",{children:"Please, log in"}),Object(d.jsx)("br",{}),"Username:",Object(d.jsx)("input",{id:"username",type:"text",value:s,onChange:function(e){return j(e.target.value)}}),Object(d.jsx)("br",{}),"Password:",Object(d.jsx)("input",{id:"password",type:"password",value:v,onChange:function(e){return O(e.target.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{id:"loginbutton",type:"submit",children:"login"})]}):Object(d.jsx)(f,{ref:U,buttonLabel:"create a new blog",children:Object(d.jsx)(g,{addingBlog:J})}),Object(d.jsx)("h2",{children:"blogs"}),n.map((function(e){return Object(d.jsx)(b,{blog:e,updatingBlog:L,removingBlog:N,user:C},e.id)}))]})};u.a.render(Object(d.jsx)(B,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.7d2b4698.chunk.js.map